# DSL Auto Fill Bot

โปรแกรมอัตโนมัติสำหรับการกรอกฟอร์มและอัปโหลดไฟล์สัญญาและแบบเบิกเงินในระบบกู้ยืมเงิน Digital Student Loan (DSL) - กองทุนเงินให้กู้ยืมเพื่อการศึกษา (กยศ.)

## คุณสมบัติ

- เข้าสู่ระบบและส่งฟอร์มอัตโนมัติ
- รองรับการทำงาน 2 ประเภท:
  - ลงนามยืนยันการเบิกเงินกู้ยืม
  - ลงนามสัญญากู้ยืมเงิน
- ระบบจัดการผู้ใช้หลายบัญชี
- ประมวลผลไฟล์แบบ batch
- ตรวจจับ checkbox แบบไดนามิก (2 หรือ 3 checkbox)
- ระบบ logging และจัดการข้อผิดพลาดที่ครอบคลุม
- จัดระเบียบไฟล์ตามผลการทำงาน


## การติดตั้ง

### 1. ดาวน์โหลดโปรแกรม
```bash
git clone https://github.com/mamamind47/dsl-autofill.git
cd sfa-dsl-autofill
```

### 2. ติดตั้ง Dependencies
```bash
pip install -r requirements.txt
```

### 3. สร้างโฟลเดอร์
**macOS/Linux:**
```bash
chmod +x setup_folders.sh
./setup_folders.sh
```

**Windows:**
```cmd
setup_folders.bat
```

## วิธีใช้งาน

### 1. เรียกใช้โปรแกรม
```bash
python main.py
```

### 2. ตั้งค่าเริ่มต้น
- เพิ่มบัญชีผู้ใช้ผ่านเมนูจัดการผู้ใช้
- กำหนดข้อมูลการเข้าสู่ระบบ DSL

### 3. เตรียมไฟล์
วางไฟล์ PDF ในโฟลเดอร์ที่เหมาะสม:
- `files/disbursement/` - ไฟล์สำหรับเบิกเงิน
- `files/sign-contract/` - ไฟล์สำหรับลงนามสัญญา

### 4. เลือกฟีเจอร์
เลือกจากเมนูหลัก:
1. **ลงนามสัญญากู้ยืมเงิน** - ประมวลผลการลงนามสัญญา
2. **ลงนามแบบยืนยันการเบิกเงินกู้ยืม** - ประมวลผลการเบิกเงิน
3. **จัดการบัญชีผู้ใช้** - เพิ่ม แก้ไข หรือเปลี่ยนบัญชีผู้ใช้

## โครงสร้างไฟล์

```
project/
├── files/
│   ├── disbursement/     # ไฟล์สำหรับเบิกเงิน
│   └── sign-contract/    # ไฟล์สำหรับลงนามสัญญา
├── completed/
│   ├── disbursement/     # ไฟล์เบิกเงินที่สำเร็จ
│   └── sign-contract/    # ไฟล์ลงนามที่สำเร็จ
├── failed/
│   ├── disbursement/     # ไฟล์เบิกเงินที่ล้มเหลว
│   └── sign-contract/    # ไฟล์ลงนามที่ล้มเหลว
├── accounts/
│   └── users.json        # ข้อมูลบัญชีผู้ใช้
└── logs/
    ├── success.log       # บันทึกความสำเร็จ
    ├── failed.log        # บันทึกความล้มเหลว
    ├── duplicate.log     # บันทึกการทำซ้ำ
    └── autofill.log      # บันทึกหลัก
```


## การจัดการผู้ใช้

โปรแกรมมีระบบจัดการผู้ใช้ที่ครอบคลุม:

- **เพิ่มผู้ใช้** - สร้างบัญชีเข้าสู่ระบบใหม่
- **เปลี่ยนผู้ใช้** - เปลี่ยนบัญชีที่ใช้งาน
- **แก้ไขผู้ใช้** - ปรับปรุงข้อมูลบัญชี
- **ลบผู้ใช้** - ลบบัญชีผู้ใช้

ข้อมูลผู้ใช้จะถูกเก็บไว้อย่างปลอดภัยใน `accounts/users.json`

## รายละเอียดการทำงาน

### ลงนามสัญญากู้ยืมเงิน
1. เข้าสู่ระบบ DSL
2. ไปยังหน้าลงนามสัญญา
3. ค้นหาไฟล์ตามชื่อ (ไม่รวมนามสกุล)
4. ประมวลผล checkbox (ตรวจจับ 2 หรือ 3 checkbox อัตโนมัติ)
5. อัปโหลดและยืนยันไฟล์
6. ย้ายไฟล์ไปโฟลเดอร์ที่เหมาะสม

### ลงนามแบบยืนยันการเบิกเงินกู้ยืม
1. เข้าสู่ระบบ DSL
2. ไปยังหน้าเบิกเงิน
3. ค้นหาไฟล์ตามชื่อ (ไม่รวมนามสกุล)
4. ตรวจจับการทำซ้ำ
5. ประมวลผลฟอร์มยินยอม
6. อัปโหลดและยืนยันไฟล์
7. ย้ายไฟล์ไปโฟลเดอร์ที่เหมาะสม

## การจัดการข้อผิดพลาด

โปรแกรมมีระบบจัดการข้อผิดพลาดดังนี้:

- **ลองเข้าสู่ระบบใหม่** - ระบบลองเข้าสู่ระบบอัตโนมัติเมื่อล้มเหลว
- **รอ Element** - รอให้องค์ประกอบหน้าเว็บโหลดอย่างชาญฉลาด
- **การย้ายไฟล์** - จัดระเบียบไฟล์สำเร็จ/ล้มเหลวอัตโนมัติ
- **การจัดการ Session** - ปิดเบราว์เซอร์อย่างถูกต้อง


## ข้อควรพิจารณาด้านความปลอดภัย
- ข้อมูลผู้ใช้ถูกเก็บไว้ในเครื่องเท่านั้น
- ไฟล์จะถูกย้าย (ไม่ใช่คัดลอก) เพื่อป้องกันการทำซ้ำ

## การแก้ไขปัญหา

### ปัญหาที่พบบ่อย

**ปัญหา ChromeDriver:**
```bash
# macOS
brew uninstall chromedriver
rm -rf ~/.wdm/drivers/chromedriver

# Windows  
rmdir /s %USERPROFILE%\.wdm\drivers\chromedriver
```

**การเข้าสู่ระบบล้มเหลว:**
- ตรวจสอบข้อมูลในการจัดการผู้ใช้
- ตรวจสอบการเชื่อมต่ออินเทอร์เน็ต
- ตรวจสอบว่าเว็บไซต์ DSL เข้าถึงได้

## การพัฒนา

### โครงสร้างโปรเจค
- `main.py` - แอปพลิเคชันหลักและตรรกะอัตโนมัติ
- `config.py` - การตั้งค่าและ CSS selectors
- `user_manager.py` - ระบบจัดการบัญชีผู้ใช้
- `path_utils.py` - การจัดการ path แบบ cross-platform


## ข้อปฏิเสธความรับผิดชอบ

เครื่องมือนี้ออกแบบมาสำหรับการทำงานอัตโนมัติสำหรับระบบ กยศ. (สำหรับตัวแทน)ผู้ใช้มีความรับผิดชอบในการปฏิบัติตามข้อกำหนดการใช้บริการและกฎระเบียบที่เกี่ยวข้องทั้งหมด
การดำเนินการต่างๆ เป็นไปตามพระราชบัญญัติว่าด้วยธุรกรรมทางอิเล็กทรอนิกส์ พ.ศ. 2544 
ผู้ใช้ถือว่าการดำเนินการทั้งหมดเป็นการดำเนินการโดยเจ้าของบัญชีนั้นๆ